TODO:
    Clean up code
    Split into multiple files
    
